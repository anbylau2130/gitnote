SELECT 
'销售订单-发货通知单' 单据类型, 
qd.FDATAVALUE AS 渠道, 
dq.FDATAVALUE AS 大区, 
sq.FDATAVALUE AS 省区, 
cust.FNUMBER AS 客户编码, 
custL.FNAME AS 客户名称, 
mtr.FNUMBER AS 物料编码, 
mtrL.FNAME AS 物料名称, 
 
ord.FBILLNO AS 销售订单编号,
ordEntry.FSEQ AS 序号,
ord.FDATE AS 销售订单日期,
ordEntry.FQTY 销售订单数量,
notice.FBILLNO AS 发货通知编号,
notice.FDATE AS 发货通知单日期,
noticeEntry.FQTY AS 发货通知单数量
 
FROM T_SAL_ORDER ord 
LEFT JOIN dbo.T_SAL_ORDERENTRY ordEntry ON ordEntry.FID = ord.FID 
LEFT JOIN dbo.T_SAL_ORDERENTRY_F ordEntryF ON ordEntryF.FENTRYID = ordEntry.FENTRYID 
LEFT JOIN dbo.T_SAL_ORDERENTRY_R ordEntryR ON ordEntryR.FENTRYID = ordEntry.FENTRYID 
LEFT JOIN T_BD_CUSTOMER cust ON ord.FCUSTID=cust.FCUSTID 
LEFT JOIN T_BD_CUSTOMER_L custL ON ord.FCUSTID=custL.FCUSTID 
LEFT JOIN dbo.T_BAS_ASSISTANTDATAENTRY_L custtype ON cust.FCUSTTYPE=custtype.FENTRYID AND custtype.FLOCALEID=2052 
LEFT JOIN dbo.T_BD_MATERIAL mtr ON mtr.FMATERIALID=ordEntry.FMATERIALID 
LEFT JOIN dbo.T_BD_MATERIAL_L mtrL ON mtrl.FMATERIALID=mtr.FMATERIALID AND mtrL.FLOCALEID=2052 
LEFT JOIN T_BAS_ASSISTANTDATAENTRY_L qd ON cust.FQUDAO=qd.FENTRYID AND qd.FLOCALEID=2052 
LEFT JOIN T_BAS_ASSISTANTDATAENTRY_L dq ON cust.FDAQU=dq.FENTRYID AND dq.FLOCALEID=2052 
LEFT JOIN T_BAS_ASSISTANTDATAENTRY_L sq ON cust.FSHENGQU=sq.FENTRYID AND sq.FLOCALEID=2052 
 LEFT JOIN T_SAL_ORDERFIN ordFIN ON ordFIN.FID = ord.FID 
INNER JOIN dbo.T_SAL_DELIVERYNOTICEENTRY_LK noticeLk ON noticeLK.FSID=ordEntry.FENTRYID AND noticeLk.FSBILLID=ordEntry.FID 
INNER JOIN T_SAL_DELIVERYNOTICEENTRY noticeEntry ON noticeEntry.FENTRYID=noticeLk.FENTRYID 
INNER JOIN T_SAL_DELIVERYNOTICE notice ON notice.FID=noticeEntry.FID 
 
 
LEFT JOIN T_HR_EMPINFO u ON cust.FEMP_DDDJ=u.FID 
LEFT JOIN T_HR_EMPINFO_L uL ON u.FID=uL.FID 
WHERE ord.FDOCUMENTSTATUS='C' AND ordEntry.FSTOCKORGID=1 
AND ord.FDATE >='2019-01-01' AND ord.FDATE<='2019-01-31' 
ORDER BY ord.FBILLNO,ordEntry.FSEQ﻿​